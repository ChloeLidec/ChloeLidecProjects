<!doctype html>
{% load static %}
<html lang="fr">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>New mdp</title>
  {% load bootstrap5 %}
  {% bootstrap_css %}
  {% bootstrap_javascript %}
</head>
<link rel="stylesheet" href="{% static 'css/connexion.css' %}">

<main id="page_connexion">
  <section class="vh-100 custom-section">
    <div class="container-fluid h-custom">
      <div class="row d-flex justify-content-center align-items-center vh-100">
        <div class="col-md-9 col-lg-6 col-xl-5">
          <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/draw2.webp" class="img-fluid"
            alt="Sample image">
        </div>
        <div class="col-md-8 col-lg-6 col-xl-4 offset-xl-1">
          <form action="{% url 'user:new-mdp' %}" method="POST">
            {% csrf_token %}

            <div class="divider d-flex align-items-center my-4">
              <p class="text-center fw-bold mx-3 mb-0">Réinitialiser le mot de passe</p>
            </div>

            {% if step1 %}

            {% if message_error %}
            <div class="alert alert-danger" role="alert">
              {{ message_error }}
            </div>
            {% endif %}

            <div class="form-outline mb-4">
              <input type="text" id="form3Example5" class="form-control form-control-lg"
                placeholder="Renseignez votre adresse e-mail" name="email"  required/>
              <label class="form-label" for="form3Example5">Adresse e-mail :</label>
            </div>

            <div class="text-center text-lg-start mt-4 pt-2">
              <button type="submit" name="action" value="envoyer_code" class="btn btn-primary btn-lg"
                style="padding-left: 2.5rem; padding-right: 2.5rem;">Envoyer le code à 6 chiffres</button>
            </div>
            {% endif %}

            {% if step2 %}
            <input type="hidden" name="email" value="{{ email }}">
            <input type="hidden" name="code_genere" value="{{ code_genere }}">

            {% if message_error %}
            <div class="alert alert-danger" role="alert">
              {{ message_error }}
            </div>
            {% endif %}

            {% if message_nv_code %}
            <div class="alert alert-primary" role="alert">
              {{ message_nv_code }}
            </div>
            {% endif %}

            <div class="form-outline mb-4">
              <input type="text" id="form3Example6" class="form-control form-control-lg"
                placeholder="Renseignez le code à 6 chiffres" name="code"/>
              <label class="form-label" for="form3Example6">Code à 6 chiffres :</label>
            </div>

            <div class="text-center text-lg-start mt-4 pt-2">
              <button type="submit" name="action" value="verifier_code" class="btn btn-primary btn-lg"
                  style="padding-left: 2.5rem; padding-right: 2.5rem;">Vérifier le code</button>
            </div>
        
            <div class="text-center text-lg-start mt-2 pt-2">
                <button type="submit" name="action" value="envoyer_code" class="btn btn-danger btn-lg"
                    style="padding-left: 2.5rem; padding-right: 2.5rem;">Renvoyer un code</button>
            </div>

            {% endif %}

            {% if step3 %}
            <input type="hidden" name="email" value="{{ email }}">
            
            {% if message_error %}
            <div class="alert alert-danger" role="alert">
              {{ message_error }}
            </div>
            {% endif %}

            <div class="form-outline mb-4">
              <input type="text" id="form3Example7" class="form-control form-control-lg"
                placeholder="Renseignez le nouveau mdp" name="mdp" required/>
              <label class="form-label" for="form3Example7">Mot de passe :</label>
            </div>

            <div class="form-outline mb-4">
              <input type="text" id="form3Example8" class="form-control form-control-lg"
                placeholder="Confirmez le nouveau mdp" name="mdp2" required/>
              <label class="form-label" for="form3Example8">Confirmer le mot de passe :</label>
            </div>

            <div class="text-center text-lg-start mt-4 pt-2">
              <button type="submit" name="action" value="verifier_nv_mdp" class="btn btn-primary btn-lg"
                  style="padding-left: 2.5rem; padding-right: 2.5rem;">Valider</button>
            </div>

            {% endif %}

          </form>
        </div>
      </div>
    </div>
  </section>
</main>
</body>

</html>